date = time) %>%
separate(date, into = c("year","month"), sep = "\\-" ) %>%
mutate(
month = as.numeric(month),
month = month.abb[month],
year = as.numeric(year),
month = as.factor(month)) %>%
arrange(year) %>%
#filter(year >= 2008) %>%
pull(rsv) %>%
na.omit() %>%
ts(frequency = 12) %>%
stl( s.window = "periodic") %>%
seasadj() %>%
ggsubseriesplot(main = "merged")
ggarrange(p3,p1,p2)
skbt %>%
rename(
date = time) %>%
separate(date, into = c("year","month"), sep = "\\-" ) %>%
mutate(
month = as.numeric(month),
month = month.abb[month],
year = as.numeric(year),
month = as.factor(month)) %>%
ggplot(aes(x=month, y= rsv, group = year))+ geom_line()
skbt %>%
rename(
date = time) %>%
separate(date, into = c("year","month"), sep = "\\-" ) %>%
mutate(
month = as.numeric(month),
month = month.abb[month],
year = as.numeric(year),
month = as.factor(month)) %>%
ggplot(aes(x=month, y= rsv, group = year, fill = year))+ geom_line()
skbt %>%
rename(
date = time) %>%
separate(date, into = c("year","month"), sep = "\\-" ) %>%
mutate(
month = as.numeric(month),
month = month.abb[month],
year = as.numeric(year),
month = as.factor(month)) %>%
ggplot(aes(x=month, y= rsv, group = year, fill = factor(year)))+ geom_line()
skbt %>%
rename(
date = time) %>%
separate(date, into = c("year","month"), sep = "\\-" ) %>%
mutate(
month = as.numeric(month),
month = month.abb[month],
year = as.numeric(year),
month = as.factor(month)) %>%
ggplot(aes(x=month, y= rsv, group = year, fill = factor(year)))+geom_line()+scale_fill_viridis_d()
skbt %>%
rename(
date = time) %>%
separate(date, into = c("year","month"), sep = "\\-" ) %>%
mutate(
month = as.numeric(month),
month = month.abb[month],
year = as.numeric(year),
month = as.factor(month)) %>%
ggplot(aes(x=month, y= rsv#, group = year
))+geom_line()+scale_fill_viridis_d()
b0<- skbt %>%
rename(
date = time) %>%
separate(date, into = c("year","month"), sep = "\\-" ) %>%
mutate(
month = as.numeric(month),
month = month.abb[month],
year = as.numeric(year),
month = as.factor(month)) %>%
pull(rsv) %>%
ts() %>%
autoplot(
main = "SKin Bleaching Trend from 2004 To 2019",
xlab = "Months",
ylab = "Relative Search Volume")
b1<- skbt %>%
rename(
date = time) %>%
separate(date, into = c("year","month"), sep = "\\-" ) %>%
mutate(
month = as.numeric(month),
month = month.abb[month],
year = as.numeric(year),
month = as.factor(month)) %>%
ggplot(aes(x=month, y= rsv#, group = year
))+labs(title = "no group")
b2<-skbt %>%
rename(
date = time) %>%
separate(date, into = c("year","month"), sep = "\\-" ) %>%
mutate(
month = as.numeric(month),
month = month.abb[month],
year = as.numeric(year),
month = as.factor(month)) %>%
ggplot(aes(x=month, y= rsv, group = year))+geom_line()+labs(title = "Grouped by year")
ggarrange(b0,b2,b1, widths = c(2,1.5))
skbt %>%
rename(
date = time) %>%
separate(date, into = c("year","month"), sep = "\\-" ) %>%
mutate(
month = as.numeric(month),
month = month.abb[month],
year = as.numeric(year),
month = as.factor(month)) %>%
ggplot(aes(x=month, y= rsv#, group = year
))+labs(title = "no group")
skbt %>%
rename(
date = time) %>%
separate(date, into = c("year","month"), sep = "\\-" ) %>%
mutate(
month = as.numeric(month),
month = month.abb[month],
year = as.numeric(year),
month = as.factor(month)) %>%
ggplot(aes(x=month, y= rsv#, group = year
))+labs(title = "no group")
b0<- skbt %>%
rename(
date = time) %>%
separate(date, into = c("year","month"), sep = "\\-" ) %>%
mutate(
month = as.numeric(month),
month = month.abb[month],
year = as.numeric(year),
month = as.factor(month)) %>%
pull(rsv) %>%
ts() %>%
autoplot(
main = "SKin Bleaching Trend from 2004 To 2019",
xlab = "Months",
ylab = "Relative Search Volume")
b1<- skbt %>%
rename(
date = time) %>%
separate(date, into = c("year","month"), sep = "\\-" ) %>%
mutate(
month = as.numeric(month),
month = month.abb[month],
year = as.numeric(year),
month = as.factor(month)) %>%
ggplot(aes(x=month, y= rsv#, group = year
))+geom_line()+labs(title = "no group")
b2<-skbt %>%
rename(
date = time) %>%
separate(date, into = c("year","month"), sep = "\\-" ) %>%
mutate(
month = as.numeric(month),
month = month.abb[month],
year = as.numeric(year),
month = as.factor(month)) %>%
ggplot(aes(x=month, y= rsv, group = year))+geom_line()+labs(title = "Grouped by year")
ggarrange(b0,b2,b1, widths = c(2,1.5))
skbt %>% rename(
date = time) %>%
separate(date, into = c("year","month"), sep = "\\-" ) %>%
mutate(
month = as.numeric(month),
month = month.abb[month],
year = as.numeric(year),
month = as.factor(month)) %>%
arrange(year) %>%
#filter(year >= 2008) %>%
pull(rsv) %>%
na.omit() %>%
ts(frequency = 365) %>%
stl( s.window = "periodic") %>%
seasadj() %>%
ggsubseriesplot(main = "Skin Bleaching")
skbt %>% rename(
date = time) %>%
separate(date, into = c("year","month"), sep = "\\-" ) %>%
mutate(
month = as.numeric(month),
month = month.abb[month],
year = as.numeric(year),
month = as.factor(month)) %>%
arrange(year) %>%
#filter(year >= 2008) %>%
pull(rsv) %>%
na.omit() %>%
ts(frequency = 52) %>%
stl( s.window = "periodic") %>%
seasadj() %>%
ggsubseriesplot(main = "Skin Bleaching")
knitr::opts_chunk$set(echo = TRUE)
Sys.setenv(census_key = "8e8b6ae296616733e0ed914129abc2c8563c9617")
readRenviron("~/.Renviron")
Sys.getenv("census_key")
library(censusapi)
listCensusApis() %>%
view()
library(tidyverse)
listCensusApis() %>%
view()
knitr::opts_chunk$set(echo = TRUE)
Sys.setenv(census_key = "8e8b6ae296616733e0ed914129abc2c8563c9617")
readRenviron("~/.Renviron")
Sys.getenv("census_key")
library(tidyverse)
library(censusapi)
listCensusApis() %>%
view()
listCensusMetadata(name = "timeseries/poverty/saipe",
type = "variables" )
listCensusMetadata(name = "timeseries/poverty/saipe",
type = "geography")
listCensusMetadata(name = "timeseries/poverty/saipe",
type = "variables" )
listCensusMetadata(name = "timeseries/poverty/saipe",
type = "geography")
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(tseries)
library(DataCombine)
library(forecast)
library(pastecs)
library(gridExtra)
library(ggpubr)
knitr::opts_chunk$set(echo = TRUE)
skbt<- read.csv("./data/GtrendData/bleachingTime08_18.csv", header = T, sep = ",",stringsAsFactors = F, col.names = c("time","rsv"))
skbt<- skbt[-1,] %>%
mutate(rsv = as.numeric(rsv))
skbt %>%
rename(
date = time) %>%
separate(date, into = c("year","month"), sep = "\\-" ) %>%
mutate(
month = as.numeric(month),
month = month.abb[month],
year = as.numeric(year),
month = as.factor(month)) %>%
arrange(year) %>%
filter(year >= 2008) %>%
ggplot(aes(x = rsv))+geom_density()
b0<- skbt %>%
rename(
date = time) %>%
separate(date, into = c("year","month"), sep = "\\-" ) %>%
mutate(
month = as.numeric(month),
month = month.abb[month],
year = as.numeric(year),
month = as.factor(month)) %>%
pull(rsv) %>%
ts() %>%
autoplot(
main = "SKin Bleaching Trend from 2004 To 2019",
xlab = "Months",
ylab = "Relative Search Volume")
b1<- skbt %>%
rename(
date = time) %>%
separate(date, into = c("year","month"), sep = "\\-" ) %>%
mutate(
month = as.numeric(month),
month = month.abb[month],
year = as.numeric(year),
month = as.factor(month)) %>%
ggplot(aes(x=month, y= rsv#, group = year
))+geom_line()+labs(title = "no group")
b2<-skbt %>%
rename(
date = time) %>%
separate(date, into = c("year","month"), sep = "\\-" ) %>%
mutate(
month = as.numeric(month),
month = month.abb[month],
year = as.numeric(year),
month = as.factor(month)) %>%
ggplot(aes(x=month, y= rsv, group = year))+geom_line()+labs(title = "Grouped by year")
ggarrange(b0,b2,b1, widths = c(2,1.5))
skbt %>%
rename(
date = time) %>%
separate(date, into = c("year","month"), sep = "\\-" ) %>%
mutate(
month = as.numeric(month),
month = month.abb[month],
year = as.numeric(year),
month = as.factor(month)) %>%
arrange(year) %>%
filter(year >= 2008) %>%
PercChange( Var = "rsv", slideBy = -1) %>%
summary() %>%
knitr::kable()
skbt %>%
rename(
date = time) %>%
separate(date, into = c("year","month"), sep = "\\-" ) %>%
mutate(
month = as.numeric(month),
month = month.abb[month],
year = as.numeric(year),
month = as.factor(month)) %>%
arrange(year)
skbt %>%
rename(
date = time) %>%
separate(date, into = c("year","month"), sep = "\\-" ) %>%
mutate(
month = as.numeric(month),
month = month.abb[month],
year = as.numeric(year),
month = as.factor(month)) %>%
arrange(year) %>%
group_by(year) %>% #look at change by year | distribution by year | change in the median or mean by year
PercChange( Var = "rsv", slideBy = -1) %>%
summary() %>%
knitr::kable()
skbt %>% rename(
date = time) %>%
separate(date, into = c("year","month"), sep = "\\-" ) %>%
mutate(
month = as.numeric(month),
month = month.abb[month],
year = as.numeric(year),
month = as.factor(month)) %>%
arrange(year) %>%
filter(year >= 2008) %>%
pull(rsv) %>%
na.omit() %>%
ts(frequency = 12) %>%
stl( s.window = "periodic") %>%
plot()
skbt %>% rename(
date = time) %>%
separate(date, into = c("year","month"), sep = "\\-" ) %>%
mutate(
month = as.numeric(month),
month = month.abb[month],
year = as.numeric(year),
month = as.factor(month)) %>%
arrange(year) %>%
filter(year >= 2008) %>%
pull(rsv) %>%
ggAcf()
skbt %>% rename(
date = time) %>%
separate(date, into = c("year","month"), sep = "\\-" ) %>%
mutate(
month = as.numeric(month),
month = month.abb[month],
year = as.numeric(year),
month = as.factor(month)) %>%
arrange(year) %>%
filter(year >= 2008) %>%
pull(rsv) %>%
ts() %>%
pastecs::trend.test(R = 1) %>%
broom::tidy() %>%
select(method, estimate, p.value) %>%
rename("r" = estimate) %>%
knitr::kable()
skbt %>% rename(
date = time) %>%
separate(date, into = c("year","month"), sep = "\\-" ) %>%
mutate(
month = as.numeric(month),
month = month.abb[month],
year = as.numeric(year),
month = as.factor(month)) %>%
arrange(year) %>%
#filter(year >= 2008) %>%
pull(rsv) %>%
na.omit() %>%
ts(frequency = 12) %>%
stl( s.window = "periodic") %>%
seasadj() %>%
ggsubseriesplot(main = "Skin Bleaching")
skbt %>% rename(
date = time) %>%
separate(date, into = c("year","month"), sep = "\\-" ) %>%
mutate(
month = as.numeric(month),
month = month.abb[month],
year = as.numeric(year),
month = as.factor(month)) %>%
arrange(year) %>%
#filter(year >= 2008) %>%
pull(rsv) %>%
na.omit() %>%
ts(frequency = 12) %>%
stl( s.window = "periodic") %>%
#seasadj() %>%
ggsubseriesplot(main = "Skin Bleaching")
skbt %>% rename(
date = time) %>%
separate(date, into = c("year","month"), sep = "\\-" ) %>%
mutate(
month = as.numeric(month),
month = month.abb[month],
year = as.numeric(year),
month = as.factor(month)) %>%
arrange(year) %>%
#filter(year >= 2008) %>%
pull(rsv) %>%
na.omit() %>%
ts(frequency = 12) %>%
stl( s.window = "periodic") %>%
ts() %>%
#seasadj() %>%
ggsubseriesplot(main = "Skin Bleaching")
skbt %>% rename(
date = time) %>%
separate(date, into = c("year","month"), sep = "\\-" ) %>%
mutate(
month = as.numeric(month),
month = month.abb[month],
year = as.numeric(year),
month = as.factor(month)) %>%
arrange(year) %>%
#filter(year >= 2008) %>%
pull(rsv) %>%
na.omit() %>%
ts(frequency = 12) %>%
stl( s.window = "periodic")
skbt %>% rename(
date = time) %>%
separate(date, into = c("year","month"), sep = "\\-" ) %>%
mutate(
month = as.numeric(month),
month = month.abb[month],
year = as.numeric(year),
month = as.factor(month)) %>%
arrange(year) %>%
#filter(year >= 2008) %>%
pull(rsv) %>%
na.omit() %>%
ts(frequency = 12) %>%
stl( s.window = "periodic") %>%
tibble() #%>%
skbt %>% rename(
date = time) %>%
separate(date, into = c("year","month"), sep = "\\-" ) %>%
mutate(
month = as.numeric(month),
month = month.abb[month],
year = as.numeric(year),
month = as.factor(month)) %>%
arrange(year) %>%
#filter(year >= 2008) %>%
pull(rsv) %>%
na.omit() %>%
ts(frequency = 12) %>%
stl( s.window = "periodic") %>%
broom::tidy() #%>%
skbt %>% rename(
date = time) %>%
separate(date, into = c("year","month"), sep = "\\-" ) %>%
mutate(
month = as.numeric(month),
month = month.abb[month],
year = as.numeric(year),
month = as.factor(month)) %>%
arrange(year) %>%
#filter(year >= 2008) %>%
pull(rsv) %>%
na.omit() %>%
ts(frequency = 12) %>%
stl( s.window = "periodic") %>%
as.data.fram() #%>%
skbt %>% rename(
date = time) %>%
separate(date, into = c("year","month"), sep = "\\-" ) %>%
mutate(
month = as.numeric(month),
month = month.abb[month],
year = as.numeric(year),
month = as.factor(month)) %>%
arrange(year) %>%
#filter(year >= 2008) %>%
pull(rsv) %>%
na.omit() %>%
ts(frequency = 12) %>%
stl( s.window = "periodic") %>%
as.data.frame() #%>%
skbt %>%
rename(
date = time) %>%
separate(date, into = c("year","month"), sep = "\\-" ) %>%
mutate(
month = as.numeric(month),
month = month.abb[month],
year = as.numeric(year),
month = as.factor(month)) %>%
arrange(year) %>%
filter(year >= 2008) %>%
ggplot(aes(x = rsv))+geom_histogram()
skbt %>%
rename(
date = time) %>%
separate(date, into = c("year","month"), sep = "\\-" ) %>%
mutate(
month = as.numeric(month),
month = month.abb[month],
year = as.numeric(year),
month = as.factor(month)) %>%
arrange(year) %>%
filter(year >= 2008) %>%
replace_na(rsv, 0) %>%
ggplot(aes(x = rsv))+geom_histogram()
