na.omit() %>%
ts(start = 2008, deltat = 1/12, end = 2018
#  name = "year"
) %>%
stl( s.window = "periodic")
skbt %>%
pull(rsv) %>%
na.omit() %>%
ts(start = 2008, deltat = 1/12,
#  name = "year"
) %>%
stl( s.window = "periodic")
b0 + b1 + plot_layout(ncol = 2)
b0 + b1 + plot_layout(nrow = 2)
(b0 | b1)
b0 + plot_layout(nrow = 2) +b1
b0 + plot_layout(ncol = 2) +b1
# global default settings for chunks
knitr::opts_chunk$set( eval = TRUE, warning = FALSE, message = FALSE,
fig.dim = c(6, 3)
)
# loaded packages; placed here to be able to load global settings
#install.packages(c("kableExtra", "patchwork","DescTools","tidyverse","tseries","DataCombine","forecast","plotly","ggpubr","gridExtra","pastecs"))
#tinytex::install_tinytex()
Packages <- c("tidyverse", "arsenal", "readxl",
"patchwork", "GGally", "ghibli","plotly","ggpubr","gridExtra",
"pastecs","forecast","DataCombine","tseries","kableExtra","viridis")
invisible(lapply(Packages, library, character.only = TRUE))
# theme global setting for ggplot
theme_set(theme_minimal() +
theme(legend.position = "bottom") +
theme(plot.title = element_text(hjust = 0.5, size = 12),
plot.subtitle = element_text(hjust = 0.5, size = 8))
)
month_name  = forcats::fct_relevel(month_name, "Jan", "Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"),
b0<- skbt  %>%
mutate(
month_name  = forcats::fct_relevel(month_name, "Jan", "Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"),
month_cont = c(1:132)) %>%
ggplot(aes(x = month_cont, y = rsv, col = year_f))+geom_line()+
labs(
title = "SKin Bleaching Trend from 2004 To 2018",
x = "Year",
y = "Relative Search Volume"
) +
scale_fill_viridis_d(option = "A", aesthetics = "col")+theme(legend.position = "bottom", axis.test.x = element_blank())
b0<- skbt  %>%
mutate(
month_name  = forcats::fct_relevel(month_name, "Jan", "Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"),
month_cont = c(1:132)) %>%
ggplot(aes(x = month_cont, y = rsv, col = year_f))+geom_line()+
labs(
title = "SKin Bleaching Trend from 2004 To 2018",
x = "Year",
y = "Relative Search Volume"
) +
scale_fill_viridis_d(option = "A", aesthetics = "col")+theme(legend.position = "bottom", axis.text.x = element_blank())
b0<- skbt  %>%
mutate(
month_name  = forcats::fct_relevel(month_name, "Jan", "Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"),
month_cont = c(1:132)) %>%
ggplot(aes(x = month_cont, y = rsv, col = year_f))+geom_line()+
labs(
title = "SKin Bleaching Trend from 2004 To 2018",
x = "Year",
y = "Relative Search Volume"
) +
scale_fill_viridis_d(option = "A", aesthetics = "col")+theme(legend.position = "bottom", axis.text.x = element_blank())
b1<- skbt %>%
ggplot(aes(x=month_name, y= rsv, col = year_f, group = year
))+geom_line()+
scale_fill_viridis_d(option = "A", aesthetics = "col")+
labs(title = "Seasonal Plot of Relative Search Volume for years 2008 - 2018", x = " Month")+theme(legend.position = "bottom")
#(b0 | b1)
b0 + plot_layout(ncol = 2) +b1
#ggarrange(b0,b1, #widths = c(2,3), ncol = 2)
month_name  = forcats::fct_relevel(month_name, "Jan", "Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"),
b0<- skbt  %>%
mutate(
month_name  = forcats::fct_relevel(month_name, "Jan", "Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"),
month_cont = c(1:132)) %>%
ggplot(aes(x = month_cont, y = rsv, col = year_f))+geom_line()+
labs(
title = "SKin Bleaching Trend from 2004 To 2018",
x = "Year",
y = "Relative Search Volume"
) +
scale_fill_viridis_d(option = "A", aesthetics = "col")+theme(legend.position = "bottom", axis.text.x = element_blank(), legend.title = "dd")
b0<- skbt  %>%
mutate(
month_name  = forcats::fct_relevel(month_name, "Jan", "Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"),
month_cont = c(1:132)) %>%
ggplot(aes(x = month_cont, y = rsv, col = year_f))+geom_line()+
labs(
title = "SKin Bleaching Trend from 2004 To 2018",
x = "Year",
y = "Relative Search Volume"
) +
scale_fill_viridis_d(option = "A", aesthetics = "col")+theme(legend.position = "bottom", axis.text.x = element_blank(), legend.text = "fdf")
b0<- skbt  %>%
mutate(
month_name  = forcats::fct_relevel(month_name, "Jan", "Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"),
month_cont = c(1:132)) %>%
ggplot(aes(x = month_cont, y = rsv, col = year_f))+geom_line()+
labs(
title = "SKin Bleaching Trend from 2004 To 2018",
x = "Year",
y = "Relative Search Volume",
fill = "Year Color"
) +
scale_fill_viridis_d(option = "A", aesthetics = "col")+theme(legend.position = "bottom", axis.text.x = element_blank(), legend.text = "fdf")
b0<- skbt  %>%
mutate(
month_name  = forcats::fct_relevel(month_name, "Jan", "Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"),
month_cont = c(1:132)) %>%
ggplot(aes(x = month_cont, y = rsv, col = year_f))+geom_line()+
labs(
title = "SKin Bleaching Trend from 2004 To 2018",
x = "Year",
y = "Relative Search Volume",
fill = "Year Color"
) +
scale_fill_viridis_d(option = "A", aesthetics = "col")+theme(legend.position = "bottom", axis.text.x = element_blank())
b0<- skbt  %>%
mutate(
month_name  = forcats::fct_relevel(month_name, "Jan", "Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"),
month_cont = c(1:132)) %>%
ggplot(aes(x = month_cont, y = rsv, col = year_f))+geom_line()+
labs(
title = "SKin Bleaching Trend from 2004 To 2018",
x = "Year",
y = "Relative Search Volume",
fill = "Year Color"
) +
scale_fill_viridis_d(option = "A", aesthetics = "col")+theme(legend.position = "bottom", axis.text.x = element_blank())
b1<- skbt %>%
ggplot(aes(x=month_name, y= rsv, col = year_f, group = year
))+geom_line()+
scale_fill_viridis_d(option = "A", aesthetics = "col")+
labs(title = "Seasonal Plot of Relative Search Volume for years 2008 - 2018", x = " Month")+theme(legend.position = "bottom")
#(b0 | b1)
b0 + plot_layout(ncol = 2) +b1
#ggarrange(b0,b1, #widths = c(2,3), ncol = 2)
b0<- skbt  %>%
mutate(
month_name  = forcats::fct_relevel(month_name, "Jan", "Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"),
month_cont = c(1:132)) %>%
ggplot(aes(x = month_cont, y = rsv, col = year_f))+geom_line()+
scale_fill_viridis_d(option = "A", aesthetics = "col")+theme(legend.position = "bottom", axis.text.x = element_blank())+
labs(
title = "SKin Bleaching Trend from 2004 To 2018",
x = "Year",
y = "Relative Search Volume",
fill = "Year Color"
)
b1<- skbt %>%
ggplot(aes(x=month_name, y= rsv, col = year_f, group = year
))+geom_line()+
scale_fill_viridis_d(option = "A", aesthetics = "col")+
labs(title = "Seasonal Plot of Relative Search Volume for years 2008 - 2018", x = " Month")+theme(legend.position = "bottom")
#(b0 | b1)
b0 + plot_layout(ncol = 2) +b1
#ggarrange(b0,b1, #widths = c(2,3), ncol = 2)
b0<- skbt  %>%
mutate(
month_name  = forcats::fct_relevel(month_name, "Jan", "Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"),
month_cont = c(1:132)) %>%
ggplot(aes(x = month_cont, y = rsv, col = year_f))+geom_line()+
scale_fill_viridis_d(option = "A", aesthetics = "col", name = "Year color")+theme(legend.position = "bottom", axis.text.x = element_blank())+
labs(
title = "SKin Bleaching Trend from 2004 To 2018",
x = "Year",
y = "Relative Search Volume",
fill = "Year Color"
)
b0<- skbt  %>%
mutate(
month_name  = forcats::fct_relevel(month_name, "Jan", "Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"),
month_cont = c(1:132)) %>%
ggplot(aes(x = month_cont, y = rsv, col = year_f))+geom_line()+
scale_fill_viridis_d(option = "A", aesthetics = "col", name = "Year color")+theme(legend.position = "bottom", axis.text.x = element_blank())+
labs(
title = "SKin Bleaching Trend from 2004 To 2018",
x = "Year",
y = "Relative Search Volume",
fill = "Year Color"
)
b1<- skbt %>%
ggplot(aes(x=month_name, y= rsv, col = year_f, group = year
))+geom_line()+
scale_fill_viridis_d(option = "A", aesthetics = "col")+
labs(title = "Seasonal Plot of Relative Search Volume for years 2008 - 2018", x = " Month")+theme(legend.position = "bottom")
#(b0 | b1)
b0 + plot_layout(ncol = 2) +b1
#ggarrange(b0,b1, #widths = c(2,3), ncol = 2)
b0<- skbt  %>%
mutate(
month_name  = forcats::fct_relevel(month_name, "Jan", "Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"),
month_cont = c(1:132)) %>%
ggplot(aes(x = month_cont, y = rsv, col = year_f))+geom_line()+
scale_fill_viridis_d(option = "A", aesthetics = "col", name = "Year Color")+theme(legend.position = "bottom", axis.text.x = element_blank())+
labs(
title = "SKin Bleaching Trend from 2004 To 2018",
x = "Year",
y = "Relative Search Volume"
)
b1<- skbt %>%
ggplot(aes(x=month_name, y= rsv, col = year_f, group = year
))+geom_line()+
scale_fill_viridis_d(option = "A", aesthetics = "col", name = "Year Color")+
labs(title = "Seasonal Plot of Relative Search Volume for years 2008 - 2018", x = " Month")+theme(legend.position = "bottom")
#(b0 | b1)
b0 + plot_layout(ncol = 2) +b1
#ggarrange(b0,b1, #widths = c(2,3), ncol = 2)
skbt  %>%
PercChange( Var = "rsv", slideBy = -1) %>%
summary() %>%
knitr::kable()
skbt  %>%
group_by(year_f) %>%
PercChange( Var = "rsv", slideBy = -1)
skbt  %>%
group_by(year_f) %>%
PercChange( Var = "rsv", slideBy = 0) %>%
summary() %>%
knitr::kable()
skbt  %>%
group_by(year_f) %>%
PercChange( Var = "rsv", slideBy = 0) %>%
summary() %>%
knitr::kable()
skbt  %>%
group_by(year_f) %>%
PercChange( Var = "rsv", slideBy = 0)
skbt  %>%
group_by(year_f) %>%
PercChange( Var = "rsv", slideBy = 1)
skbt %>%
pull(rsv) %>%
ggAcf()
skbt %>%
pull(rsv) %>%
ts() %>%
pastecs::trend.test(R = 1) %>%
broom::tidy() %>%
select(method, estimate, p.value) %>%
rename("r" = estimate) %>%
knitr::kable()
state.name
state.abb
state.x77
left_join(state.abb, skbr, by = "state")
state.abb
#merging both the codes and rsv together within ploty commands using left_join.
p <- plot_geo(
#data set
state.abb[match(skbr$state, state.name)]
left_join(codes, skbr, by = "state"),
state.abb[match(skbr$state, state.name)]
tibble(state.abb[match(skbr$state, state.name)],skbr$rsv)
#merging both the codes and rsv together within ploty commands using left_join.
p <- plot_geo(
#data set
data = tibble(state.abb[match(skbr$state, state.name)],skbr$rsv),
#left_join(codes, skbr, by = "state"),
#map
locationmode = 'USA-states') %>%
add_trace(
z = ~rsv,
#text = ~hover,
locations = ~code,
color = ~rsv, colors = 'Purples'
) %>%
colorbar(title = "Volume In Percentage") %>%
layout(
title = 'Relative Search Volume of <br> Skin Bleaching in The US 2008 - 2018',
geo = g
)
tibble(state.abb[match(skbr$state, state.name)],skbr$rsv)
#merging both the codes and rsv together within ploty commands using left_join.
p <- plot_geo(
#data set
data = tibble(state.abb[match(skbr$state, state.name)],rsv = skbr$rsv),
#left_join(codes, skbr, by = "state"),
#map
locationmode = 'USA-states') %>%
add_trace(
z = ~rsv,
#text = ~hover,
locations = ~code,
color = ~rsv, colors = 'Purples'
) %>%
colorbar(title = "Volume In Percentage") %>%
layout(
title = 'Relative Search Volume of <br> Skin Bleaching in The US 2008 - 2018',
geo = g
)
#merging both the codes and rsv together within ploty commands using left_join.
p <- plot_geo(
#data set
data = tibble(code =state.abb[match(skbr$state, state.name)],rsv = skbr$rsv),
#left_join(codes, skbr, by = "state"),
#map
locationmode = 'USA-states') %>%
add_trace(
z = ~rsv,
#text = ~hover,
locations = ~code,
color = ~rsv, colors = 'Purples'
) %>%
colorbar(title = "Volume In Percentage") %>%
layout(
title = 'Relative Search Volume of <br> Skin Bleaching in The US 2008 - 2018',
geo = g
)
p
# give state boundaries a white border
l <- list(color = toRGB("white"), width = 2)
# specify some map projection/options
g <- list(
scope = 'usa',
projection = list(type = 'albers usa'),
showlakes = TRUE,
lakecolor = toRGB('white')
)
#merging both the codes and rsv together within ploty commands using left_join.
p <- plot_geo(
#data set
data = tibble(code =state.abb[match(skbr$state, state.name)],rsv = skbr$rsv),
#left_join(codes, skbr, by = "state"),
#map
locationmode = 'USA-states') %>%
add_trace(
z = ~rsv,
#text = ~hover,
locations = ~code,
color = ~rsv, colors = 'Purples'
) %>%
colorbar(title = "Volume In Percentage") %>%
layout(
title = 'Relative Search Volume of <br> Skin Bleaching in The US 2008 - 2018',
geo = g
)
p
#merging both the codes and rsv together within ploty commands using left_join.
p <- plot_geo(
#data set
tibble(code =state.abb[match(skbr$state, state.name)],rsv = skbr$rsv),
#left_join(codes, skbr, by = "state"),
#map
locationmode = 'USA-states') %>%
add_trace(
z = ~rsv,
#text = ~hover,
locations = ~code,
color = ~rsv, colors = 'Purples'
) %>%
colorbar(title = "Volume In Percentage") %>%
layout(
title = 'Relative Search Volume of <br> Skin Bleaching in The US 2008 - 2018',
geo = g
)
p
as.tibble(state.abb, state.name)
as_tibble(state.abb, state.name)
as_tibble(abb = state.abb, state = state.name)
as_tibble(state.abb = "abb", state.name = "state")
full_join(state.abb, state.name)
# global default settings for chunks
knitr::opts_chunk$set( eval = TRUE, warning = FALSE, message = FALSE,
fig.dim = c(6, 3)
)
# loaded packages; placed here to be able to load global settings
#install.packages(c("kableExtra", "patchwork","DescTools","tidyverse","tseries","DataCombine","forecast","plotly","ggpubr","gridExtra","pastecs"))
#tinytex::install_tinytex()
Packages <- c("tidyverse", "arsenal", "readxl",
"patchwork", "GGally", "ghibli","plotly","ggpubr","gridExtra",
"pastecs","forecast","DataCombine","tseries","kableExtra","viridis")
invisible(lapply(Packages, library, character.only = TRUE))
# theme global setting for ggplot
theme_set(theme_minimal() +
theme(legend.position = "bottom") +
theme(plot.title = element_text(hjust = 0.5, size = 12),
plot.subtitle = element_text(hjust = 0.5, size = 8))
)
skbt  %>%
PercChange( Var = "rsv", slideBy = 1) %>%
summary() %>%
knitr::kable()
skbt  %>%
PercChange( Var = "rsv", slideBy = 1, GroupVar = "year_f") %>%
summary() %>%
knitr::kable()
skbt  %>%
PercChange( Var = "rsv", slideBy = 1, GroupVar = "year_f") %>% plot(rsv_PChangeFrom1)
skbt  %>%
PercChange( Var = "rsv", slideBy = 1, GroupVar = "year_f") %>% plot()
skbt  %>%
PercChange( Var = "rsv", slideBy = 1, GroupVar = "year_f") %>% ggpairs()
b0<- skbt  %>%
mutate(
month_name  = forcats::fct_relevel(month_name, "Jan", "Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"),
month_cont = c(1:132)) %>%
ggplot(aes(x = month_cont, y = rsv, col = year_f))+geom_line()+
scale_fill_viridis_d(option = "A", aesthetics = "col", name = "Year Color")+theme(legend.position = "bottom", axis.text.x = element_blank())+
labs(
title = "SKin Bleaching Trend from 2004 To 2018",
x = "Year",
y = "Relative Search Volume"
)
b1<- skbt %>%
ggplot(aes(x=month_name, y= rsv, col = year_f, group = year
))+geom_line()+
scale_fill_viridis_d(option = "A", aesthetics = "col", name = "Year Color")+
labs(title = "Seasonal Plot of Relative Search Volume for years 2008 - 2018", x = " Month")+theme(legend.position = "bottom")
b0 + plot_layout(ncol = 2) +b1
b0<- skbt  %>%
mutate(
month_name  = forcats::fct_relevel(month_name, "Jan", "Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"),
month_cont = c(1:132)) %>%
ggplot(aes(x = month_name, y = rsv, col = year_f))+geom_line()+
scale_fill_viridis_d(option = "A", aesthetics = "col", name = "Year Color")+theme(legend.position = "bottom", axis.text.x = element_blank())+
labs(
title = "SKin Bleaching Trend from 2004 To 2018",
x = "Year",
y = "Relative Search Volume"
)
b1<- skbt %>%
ggplot(aes(x=month_name, y= rsv, col = year_f, group = year
))+geom_line()+
scale_fill_viridis_d(option = "A", aesthetics = "col", name = "Year Color")+
labs(title = "Seasonal Plot of Relative Search Volume for years 2008 - 2018", x = " Month")+theme(legend.position = "bottom")
b0 + plot_layout(ncol = 2) +b1
b0<- skbt  %>%
mutate(
month_name  = forcats::fct_relevel(month_name, "Jan", "Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"),
month_cont = c(1:132)) %>%
ggplot(aes(x = month_cont, y = rsv, col = year_f))+geom_line()+
scale_fill_viridis_d(option = "A", aesthetics = "col", name = "Year Color")+theme(legend.position = "bottom", axis.text.x = element_blank())+
labs(
title = "SKin Bleaching Trend from 2004 To 2018",
x = "Year",
y = "Relative Search Volume"
)
b1<- skbt %>%
ggplot(aes(x=month_name, y= rsv, col = year_f, group = year
))+geom_line()+
scale_fill_viridis_d(option = "A", aesthetics = "col", name = "Year Color")+
labs(title = "Seasonal Plot of Relative Search Volume for years 2008 - 2018", x = " Month")+theme(legend.position = "bottom")
b0 + plot_layout(ncol = 2) +b1
b0<- skbt  %>%
mutate(
month_name  = forcats::fct_relevel(month_name, "Jan", "Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"),
month_cont = c(1:132)) %>%
ggplot(aes(x = month_cont, y = rsv, col = year_f))+geom_line()+
scale_fill_viridis_d(option = "A", aesthetics = "col", name = "Year Color")+theme(legend.position = "bottom", axis.text.x = element_blank())+
labs(
title = "SKin Bleaching Trend from 2004 To 2018",
x = "Year",
y = "Relative Search Volume"
)
b1<- skbt %>%
mutate(
month_name  = forcats::fct_relevel(month_name, "Jan", "Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"),
month_cont = c(1:132)) %>%
ggplot(aes(x=month_name, y= rsv, col = year_f, group = year
))+geom_line()+
scale_fill_viridis_d(option = "A", aesthetics = "col", name = "Year Color")+
labs(title = "Seasonal Plot of Relative Search Volume for years 2008 - 2018", x = " Month")+theme(legend.position = "bottom")
b0 + plot_layout(ncol = 2) +b1
skbt  %>%
PercChange( Var = "rsv", slideBy = 1, GroupVar = "year_f") %>% broom::tidy()
skbt  %>%
PercChange( Var = "rsv", slideBy = 1, GroupVar = "year_f") %>%
summary() %>%
knitr::kable()
skbt  %>%
PercChange( Var = "rsv", slideBy = 1, GroupVar = "year_f") %>% ggpairs()
skbt  %>%
PercChange( Var = "rsv", slideBy = 1, GroupVar = "year_f") %>%
summary() %>%
knitr::kable()
skbt  %>%
PercChange( Var = "rsv", slideBy = 1, GroupVar = "year_f") %>% ggpairs()
skbt  %>%
PercChange( Var = "rsv", slideBy = 1, GroupVar = "year_f") %>%
ggplot(aes(x = year_f, y = `rsv_PChangeFrom1`))+
geom_boxplot()
b0<- skbt  %>%
mutate(
month_name  = forcats::fct_relevel(month_name, "Jan", "Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"),
month_cont = c(1:132)) %>%
ggplot(aes(x = month_cont, y = rsv, col = year_f))+geom_line()+
scale_fill_viridis_d("year_f")+theme(legend.position = "bottom", axis.text.x = element_blank())+
labs(
title = "SKin Bleaching Trend from 2004 To 2018",
x = "Year",
y = "Relative Search Volume"
)
b1<- skbt %>%
mutate(
month_name  = forcats::fct_relevel(month_name, "Jan", "Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"),
month_cont = c(1:132)) %>%
ggplot(aes(x=month_name, y= rsv, col = year_f, group = year
))+geom_line()+
scale_fill_viridis_d(option = "A", aesthetics = "col", name = "Year Color")+
labs(title = "Seasonal Plot of Relative Search Volume for years 2008 - 2018", x = " Month")+theme(legend.position = "bottom")
b0 + plot_layout(ncol = 2) +b1
# loaded packages; placed here to be able to load global settings
#install.packages(c("kableExtra", "patchwork","DescTools","tidyverse","tseries","DataCombine","forecast","plotly","ggpubr","gridExtra","pastecs"))
#tinytex::install_tinytex()
install.packages("RColorBrewer")
