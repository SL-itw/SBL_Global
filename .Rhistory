med_rsv = median(rsv, na.rm = T)) %>%
PercChange(Var = "mean_rsv", slideBy = 1)
skbt %>%
group_by(year) %>%
summarize(
mean_rsv = mean(rsv, na.rm = T),
sd_rsv = sd(rsv),
med_rsv = median(rsv, na.rm = T)) %>%
PercChange(Var = "mean_rsv", slideBy = -1)
mean_rsv = mean(rsv, na.rm = T),
skbt %>%
group_by(year) %>%
summarize(
mean_rsv = mean(rsv, na.rm = T),
sd_rsv = sd(rsv),
med_rsv = median(rsv, na.rm = T)) %>%
PercChange(Var = "mean_rsv", slideBy = -1, type = "percent")
skbt %>%
group_by(year) %>%
summarize(
mean_rsv = mean(rsv, na.rm = T),
sd_rsv = sd(rsv),
med_rsv = median(rsv, na.rm = T)) %>%
PercChange(Var = "mean_rsv", slideBy = -1, type = "percent", NewVar = "percent change")
skbt %>%
group_by(year) %>%
summarize(
mean_rsv = mean(rsv, na.rm = T),
sd_rsv = sd(rsv),
med_rsv = median(rsv, na.rm = T)) %>%
PercChange(Var = "mean_rsv", slideBy = -1, type = "percent", NewVar = "percent change",...)
mean_rsv = mean(rsv, na.rm = T),
skbt %>%
group_by(year) %>%
summarize(
mean_rsv = mean(rsv, na.rm = T),
sd_rsv = sd(rsv),
med_rsv = median(rsv, na.rm = T)) %>%
PercChange(Var = "mean_rsv", slideBy = -1, type = "percent", NewVar = "percent change",... = mean_rsv)
# Create fake data frame
A <- c(1, 1, 1, 1, 1, 2, 2, 2, 2, 2)
B <- c(1:10)
Data <- data.frame(A, B)
# Find percentage change from two periods before
Out <- PercChange(Data, Var = 'B',
type = 'proportion',
NewVar = 'PercentChange',
slideBy = -2)
Out
perChange <- function(x){
for (i in length(x)) {
p = (x[i+1]-x[i])/x[i]
}}
perChange <- function(x){
for (i in length(x)) {
p = (x[i+1]-x[i])/x[i]
return(p)
}}
perChange(Data$B)
perChange(Data)
skbt %>%
group_by(year) %>%
summarize(
mean_rsv = mean(rsv, na.rm = T),
sd_rsv = sd(rsv),
med_rsv = median(rsv, na.rm = T)) %>%
PercChange(Var = "mean_rsv", slideBy = -1, type = "percent", NewVar = "percent change",... = mean_rsv)
skbt %>%
group_by(year) %>%
summarize(
mean_rsv = mean(rsv, na.rm = T),
sd_rsv = sd(rsv),
med_rsv = median(rsv, na.rm = T)) %>%
PercChange(Var = "mean_rsv", slideBy = -1, type = "percent", NewVar = "percent change")
skbt %>%
group_by(year) %>%
summarize(
mean_rsv = mean(rsv, na.rm = T),
sd_rsv = sd(rsv),
med_rsv = median(rsv, na.rm = T)) %>%
PercChange(data = ., Var = "mean_rsv", slideBy = -1, type = "percent", NewVar = "percent change")
skbt %>%
group_by(year) %>%
summarize(
mean_rsv = mean(rsv, na.rm = T),
sd_rsv = sd(rsv),
med_rsv = median(rsv, na.rm = T))
perChange <- function(x){
for (i in length(x)) {
p = (x[i+1]-x[i])/x[i]
}}
perChange(Data$B)
perChange(Data$B)
(perChange(Data$B))
perChange <-
for (i in length(x)) {
function(x){
p = (x[i+1]-x[i])/x[i]
}}
map(Data$B, perChange)
(map(Data$B, perChange))
perChange <- function(x){
for (i in length(x)) {
p = (x[[i+1]]-x[[i]])/x[[i]]
}}
(map(Data$B, perChange))
(perChange(Data$B))
perChange <- function(x){
for (i in length(x)) {
p = (x[i+1]-x[i])/x[i]
i = 1+i
}}
(map(Data$B, perChange))
(perChange(Data$B))
perChange <- function(x){
for (i in 1:length(x)) {
p = (x[i+1]-x[i])/x[i]
i = 1+i
}}
(map(Data$B, perChange))
(perChange(Data$B))
perChange <- function(x){
for (i in 1:length(x)) {
p = (x[i+1]-x[i])/x[i]
}}
(map(Data$B, perChange))
(perChange(Data$B))
Data$B[1]
(Data$B[2]-Data$B[1])/Data$B[1]
(Data$B[3]-Data$B[2])/Data$B[2]
(Data$B[3]-Data$B[2])/Data$B[2]*100
(Data$B[6]-Data$B[5])/Data$B[5]*100
1:length(Data$B)
perChange <- function(x){
p = (x[i+1]-x[i])/x[i]*100
}
(map(Data$B, perChange))
perChange <- function(x){
for (i in 1:length(x)) {
p = (x[i+1]-x[i])/x[i]*100
}
i=1+i
}
(map(Data$B, perChange))
perChange <- function(x){
for (i in 1:length(x)) {
p = (x[i+1]-x[i])/x[i]*100
i=1+i
}
return(p)
}
(perChange(Data$B))
(map(Data$B, perChange))
perChange <- function(x){
for (i in 1:length(x)) {
p = (x[i+1]-x[i])/x[i]*100
i=1+i
}
}
(map(Data$B, perChange))
perChange <- function(x){
for (i in 1:length(x)) {
p = (x[i+1]-x[i])/x[i]*100
}
i= i-1
}
(map(Data$B, perChange))
perChange <- function(x){
for (i in 1:length(x)){
p = (x[i+1]-x[i])/x[i]*100
p
}
i = i-1
}
(map(Data$B, perChange))
for (i in 1:length(Data$B)){
p = (Data$B[i+1]-Data$B[i])/Data$B[i]*100
p
}
(for (i in 1:length(Data$B)){
p = (Data$B[i+1]-Data$B[i])/Data$B[i]*100
p
})
(for (i in 1:length(Data$B)){
p = (Data$B[i+1]-Data$B[i])/Data$B[i]*100
return(p)
})
(for (i in 1:length(Data$B)){
p = (Data$B[i]-Data$B[i])/Data$B[i]*100
return(p)
})
p = vector(length = NULL, mode = "logical")
p = c()
(for (i in 1:length(Data$B)){
p = (Data$B[i]-Data$B[i])/Data$B[i]*100
return(p)
})
(Data$B[6]-Data$B[5])/Data$B[5]*100
P= (Data$B[6]-Data$B[5])/Data$B[5]*100
P
p = c()
(for (i in 1:length(Data$B)){
p = (Data$B[i]-Data$B[i])/Data$B[i]*100
append(p)
})
(for (i in 1:length(Data$B)){
p = (Data$B[i]-Data$B[i])/Data$B[i]*100
})
p
p = c()
(for (i in 1:length(Data$B)){
p = (Data$B[i+1]-Data$B[i])/Data$B[i]*100
})
p = c()
(for (i in 2:length(Data$B)){
p = (Data$B[i+1]-Data$B[i])/Data$B[i]*100
})
p = c()
(for (i in 0:2){
p = (Data$B[i+1]-Data$B[i])/Data$B[i]*100
})
p = c()
(for (i in 1:2){
p = (Data$B[i+1]-Data$B[i])/Data$B[i]*100
})
perChange <- function(x){
p = (x[]-x[])/x[]*100
}
(map(Data$B, perChange))
perChange <- function(x){
p = (x[]-x[-1])/x[-1]*100
}
(map(Data$B, perChange))
skbt %>%
group_by(year) %>%
summarize(
mean_rsv = mean(rsv, na.rm = T),
sd_rsv = sd(rsv),
med_rsv = median(rsv, na.rm = T)) %>%
mutate(
per_change = (mean_rsv/lead(mean_rsv) - 1)*100)
per_change = (mean_rsv/lead(mean_rsv) - 1)
lead(skbt$rsv)
mean(skbt$rsv)/lead(skbt$rsv)
mean(skbt$rsv)
lead(skbt$rsv)
(skbt$rsv)
lead(skbt$rsv)
skbt %>%
group_by(year) %>%
summarize(
mean_rsv = mean(rsv, na.rm = T),
sd_rsv = sd(rsv),
med_rsv = median(rsv, na.rm = T)) %>%
mutate(
per_change = (lead(mean_rsv)-mean_rsv)/mean_rsv*100)
(skbt$rsv)
lead(skbt$rsv)
skbt %>%
group_by(year) %>%
summarize(
mean_rsv = mean(rsv, na.rm = T),
sd_rsv = sd(rsv),
med_rsv = median(rsv, na.rm = T)) %>%
mutate(
per_change = (lead(mean_rsv)-mean_rsv)/mean_rsv*100)
skbt %>%
group_by(year) %>%
summarize(
mean_rsv = mean(rsv, na.rm = T),
sd_rsv = sd(rsv),
med_rsv = median(rsv, na.rm = T)) %>%
mutate(
per_change = (lead(mean_rsv)-mean_rsv)/mean_rsv*100) %>%
ggplot(aes(x = year, y = per_change))+geom_point()
per_change = (lead(mean_rsv)-mean_rsv)/mean_rsv*100) %>%
skbt %>%
group_by(year) %>%
summarize(
mean_rsv = mean(rsv, na.rm = T),
sd_rsv = sd(rsv),
med_rsv = median(rsv, na.rm = T)) %>%
mutate(
per_change = (lead(mean_rsv)-mean_rsv)/mean_rsv*100) %>%
summarize(per_change)
skbt %>%
group_by(year) %>%
summarize(
mean_rsv = mean(rsv, na.rm = T),
sd_rsv = sd(rsv),
med_rsv = median(rsv, na.rm = T)) %>%
mutate(
per_change = (lead(mean_rsv)-mean_rsv)/mean_rsv*100) %>%
summary(per_change)
skbt %>%
group_by(year) %>%
summarize(
mean_rsv = mean(rsv, na.rm = T),
sd_rsv = sd(rsv),
med_rsv = median(rsv, na.rm = T)) %>%
mutate(
per_change = (lead(mean_rsv)-mean_rsv)/mean_rsv*100) %>%
pull(per_change) %>%
summary()
skbt %>%
group_by(year) %>%
summarize(
mean_rsv = mean(rsv, na.rm = T),
sd_rsv = sd(rsv),
med_rsv = median(rsv, na.rm = T)) %>%
mutate(
per_change = (lead(mean_rsv)-mean_rsv)/mean_rsv*100,
per_change2 = (lead(mean_rsv)-mean_rsv[1])/mean_rsv[1]*100)
skbt %>%
group_by(year) %>%
summarize(
mean_rsv = mean(rsv, na.rm = T),
sd_rsv = sd(rsv),
med_rsv = median(rsv, na.rm = T)) %>%
mutate(
per_change = (lead(mean_rsv)-mean_rsv)/mean_rsv*100,
per_change2 = (lead(mean_rsv)-mean_rsv[1])/mean_rsv[1]*100) %>%
pull(per_change, per_change2) %>%
summary()
skbt %>%
group_by(year) %>%
summarize(
mean_rsv = mean(rsv, na.rm = T),
sd_rsv = sd(rsv),
med_rsv = median(rsv, na.rm = T)) %>%
mutate(
per_change = (lead(mean_rsv)-mean_rsv)/mean_rsv*100,
per_change2 = (lead(mean_rsv)-mean_rsv[1])/mean_rsv[1]*100) %>%
select(per_change, per_change2) %>%
summary()
skbt %>%
group_by(year) %>%
summarize(
mean_rsv = mean(rsv, na.rm = T),
sd_rsv = sd(rsv),
med_rsv = median(rsv, na.rm = T)) %>%
mutate(
per_change = (lead(mean_rsv)-mean_rsv)/mean_rsv*100,
per_change2 = (lead(mean_rsv)-mean_rsv[1])/mean_rsv[1]*100) %>%
ggplot(aes(x = year, y = per_change))+geom_point()+geom_point(aes(x = year, y = per_change2))
skbt %>%
group_by(year) %>%
summarize(
mean_rsv = mean(rsv, na.rm = T),
sd_rsv = sd(rsv),
med_rsv = median(rsv, na.rm = T)) %>%
mutate(
per_change = (lead(mean_rsv)-mean_rsv)/mean_rsv*100,
per_change2 = (lead(mean_rsv)-mean_rsv[1])/mean_rsv[1]*100) %>%
ggplot(aes(x = year, y = per_change))+geom_point()+geom_point(aes(x = year, y = per_change2, col = "red"))
skbt %>%
group_by(year) %>%
summarize(
mean_rsv = mean(rsv, na.rm = T),
sd_rsv = sd(rsv),
med_rsv = median(rsv, na.rm = T)) %>%
mutate(
per_change = (lead(mean_rsv)-mean_rsv)/mean_rsv*100,
per_change2 = (lead(mean_rsv)-mean_rsv[1])/mean_rsv[1]*100) %>%
ggplot(aes(x = year, y = per_change))+
geom_point(aes(col = "blue"))+
geom_point(aes(x = year, y = per_change2, col = "red"))
skbt %>%
group_by(year) %>%
summarize(
mean_rsv = mean(rsv, na.rm = T),
sd_rsv = sd(rsv),
med_rsv = median(rsv, na.rm = T)) %>%
mutate(
per_change = (lead(mean_rsv)-mean_rsv)/mean_rsv*100,
per_change2 = (lead(mean_rsv)-mean_rsv[1])/mean_rsv[1]*100) %>%
ggplot()+
geom_point(aes(x = year, y = per_change, col = "blue"))+
geom_point(aes(x = year, y = per_change2, col = "red"))
skbt %>%
group_by(year) %>%
summarize(
mean_rsv = mean(rsv, na.rm = T),
sd_rsv = sd(rsv),
med_rsv = median(rsv, na.rm = T)) %>%
mutate(
per_change = (lead(mean_rsv)-mean_rsv)/mean_rsv*100,
per_change2 = (lead(mean_rsv)-mean_rsv[1])/mean_rsv[1]*100) %>%
ggplot()+
geom_point(aes(x = year, y = per_change, fill = "blue"))+
geom_point(aes(x = year, y = per_change2, fill = "red"))
skbt %>%
group_by(year) %>%
summarize(
mean_rsv = mean(rsv, na.rm = T),
sd_rsv = sd(rsv),
med_rsv = median(rsv, na.rm = T)) %>%
mutate(
per_change = (lead(mean_rsv)-mean_rsv)/mean_rsv*100,
per_change2 = (lead(mean_rsv)-mean_rsv[1])/mean_rsv[1]*100) %>%
ggplot()+
geom_point(aes(x = year, y = per_change, fill = "blue"))+
geom_point(aes(x = year, y = per_change2, fill = "red"))+
scale_fill_viridis_d()
skbt %>%
group_by(year) %>%
summarize(
mean_rsv = mean(rsv, na.rm = T),
sd_rsv = sd(rsv),
med_rsv = median(rsv, na.rm = T)) %>%
mutate(
per_change = (lead(mean_rsv)-mean_rsv)/mean_rsv*100,
per_change2 = (lead(mean_rsv)-mean_rsv[1])/mean_rsv[1]*100) %>%
ggplot()+
geom_point(aes(x = year, y = per_change))+
geom_point(aes(x = year, y = per_change2, col = "red"))+
scale_fill_viridis_d()
skbt %>%
group_by(year) %>%
summarize(
mean_rsv = mean(rsv, na.rm = T),
sd_rsv = sd(rsv),
med_rsv = median(rsv, na.rm = T)) %>%
mutate(
per_change = (lead(mean_rsv)-mean_rsv)/mean_rsv*100,
per_change2 = (lead(mean_rsv)-mean_rsv[1])/mean_rsv[1]*100) %>%
ggplot()+
geom_point(aes(x = year, y = per_change2, col = "red"))+
geom_point(aes(x = year, y = per_change))
skbt %>%
group_by(year) %>%
summarize(
mean_rsv = mean(rsv, na.rm = T),
sd_rsv = sd(rsv),
med_rsv = median(rsv, na.rm = T)) %>%
mutate(
per_change = (lead(mean_rsv)-mean_rsv)/mean_rsv*100,
per_change2 = (lead(mean_rsv)-mean_rsv[1])/mean_rsv[1]*100) %>%
ggplot()+
geom_point(aes(x = year, y = per_change2, col = "red"))+
geom_point(aes(x = year, y = per_change, col = "blue"))
skbt %>%
group_by(year) %>%
summarize(
mean_rsv = mean(rsv, na.rm = T),
sd_rsv = sd(rsv),
med_rsv = median(rsv, na.rm = T)) %>%
mutate(
per_change = (lead(mean_rsv)-mean_rsv)/mean_rsv*100,
per_change2 = (lead(mean_rsv)-mean_rsv[1])/mean_rsv[1]*100) %>%
ggplot()+
geom_point(aes(x = year, y = per_change2, colour = "red"))+
geom_point(aes(x = year, y = per_change,colour = "blue"))
skbt %>%
group_by(year) %>%
summarize(
mean_rsv = mean(rsv, na.rm = T),
sd_rsv = sd(rsv),
med_rsv = median(rsv, na.rm = T)) %>%
mutate(
per_change = (lead(mean_rsv)-mean_rsv)/mean_rsv*100,
per_change2 = (lead(mean_rsv)-mean_rsv[1])/mean_rsv[1]*100) %>%
ggplot()+
geom_point(aes(x = year, y = per_change2, colour = "red"))+
geom_point(aes(x = year, y = per_change,colour = "green"))
skbt %>%
group_by(year) %>%
summarize(
mean_rsv = mean(rsv, na.rm = T),
sd_rsv = sd(rsv),
med_rsv = median(rsv, na.rm = T)) %>%
mutate(
per_change = (lead(mean_rsv)-mean_rsv)/mean_rsv*100,
per_change2 = (lead(mean_rsv)-mean_rsv[1])/mean_rsv[1]*100) %>%
ggplot()+
geom_point(aes(x = year, y = per_change2, colour = "red"))+
geom_point(aes(x = year, y = per_change))
skbt %>%
group_by(year) %>%
summarize(
mean_rsv = mean(rsv, na.rm = T),
sd_rsv = sd(rsv),
med_rsv = median(rsv, na.rm = T)) %>%
mutate(
per_change = (lead(mean_rsv)-mean_rsv)/mean_rsv*100,
per_change2 = (lead(mean_rsv)-mean_rsv[1])/mean_rsv[1]*100) %>%
ggplot()+
#  geom_point(aes(x = year, y = per_change2, colour = "red"))+
geom_point(aes(x = year, y = per_change))
skbt %>%
group_by(year) %>%
summarize(
mean_rsv = mean(rsv, na.rm = T),
sd_rsv = sd(rsv),
med_rsv = median(rsv, na.rm = T)) %>%
mutate(
per_change = (lead(mean_rsv)-mean_rsv)/mean_rsv*100,
per_change2 = (lead(mean_rsv)-mean_rsv[1])/mean_rsv[1]*100) %>%
select(per_change, per_change2) %>%
summary()
skbt %>%
group_by(year) %>%
summarize(
mean_rsv = mean(rsv, na.rm = T),
sd_rsv = sd(rsv),
med_rsv = median(rsv, na.rm = T)) %>%
mutate(
per_change = (lead(mean_rsv)-mean_rsv)/mean_rsv*100,
per_change2 = (lead(mean_rsv)-mean_rsv[1])/mean_rsv[1]*100) %>%
ggplot()+
geom_point(aes(x = year, y = per_change2, colour = "red"))+
geom_point(aes(x = year, y = per_change))
