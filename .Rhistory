mutate(
month_name  = forcats::fct_relevel(month_name, "Jan", "Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"),
month_cont = c(1:132)) %>%
ggplot(aes(x = month_cont, y = rsv, col = year))+geom_line()+
labs(
title = "SKin Bleaching Trend from 2004 To 2018",
x = "Months",
y = "Relative Search Volume"
)
skbt  %>%
mutate(
month_name  = forcats::fct_relevel(month_name, "Jan", "Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"),
month_cont = c(1:132)) %>%
ggplot(aes(x = month_cont, y = rsv, col = year))+geom_line()+
labs(
title = "SKin Bleaching Trend from 2004 To 2018",
x = "Months",
y = "Relative Search Volume"
) +
scale_fill_viridis_c(option = "A", aesthetics = "col")
b0<- skbt  %>%
mutate(
month_name  = forcats::fct_relevel(month_name, "Jan", "Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"),
month_cont = c(1:132)) %>%
ggplot(aes(x = month_cont, y = rsv, col = year))+geom_line()+
labs(
title = "SKin Bleaching Trend from 2004 To 2018",
x = "Months",
y = "Relative Search Volume"
) +
scale_fill_viridis_d(option = "A", aesthetics = "col")
b0<- skbt  %>%
mutate(
month_name  = forcats::fct_relevel(month_name, "Jan", "Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"),
month_cont = c(1:132)) %>%
ggplot(aes(x = month_cont, y = rsv, col = year))+geom_line()+
labs(
title = "SKin Bleaching Trend from 2004 To 2018",
x = "Months",
y = "Relative Search Volume"
) +
scale_fill_viridis_d(option = "A", aesthetics = "col")
b1<- skbt %>%
ggplot(aes(x=month, y= rsv, col = year, group = year
))+geom_line()+
scale_fill_viridis_c(option = "A", aesthetics = "col")+
labs(title = "Seasonal Plot of Relative Search Volume for years 2008 - 2018")
b2<-skbt %>%
ggplot(aes(x=month, y= rsv, col = year))+geom_line()+labs(title = "Grouped by year")+
scale_fill_viridis_c(option = "A", aesthetics = "col")
ggarrange(b0,b2,b1, widths = c(2,1.5))
b0<- skbt  %>%
mutate(
month_name  = forcats::fct_relevel(month_name, "Jan", "Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"),
month_cont = c(1:132)) %>%
ggplot(aes(x = month_cont, y = rsv, col = year))+geom_line()+
labs(
title = "SKin Bleaching Trend from 2004 To 2018",
x = "Months",
y = "Relative Search Volume"
) +
scale_fill_viridis_d(option = "A", aesthetics = "col")
b1<- skbt %>%
ggplot(aes(x=month_name, y= rsv, col = year, group = year
))+geom_line()+
scale_fill_viridis_d(option = "A", aesthetics = "col")+
labs(title = "Seasonal Plot of Relative Search Volume for years 2008 - 2018")
b2<-skbt %>%
ggplot(aes(x=month_name, y= rsv, col = year))+geom_line()+labs(title = "Grouped by year")+
scale_fill_viridis_d(option = "A", aesthetics = "col")
ggarrange(b0,b2,b1, widths = c(2,1.5))
b0<- skbt  %>%
mutate(
month_name  = forcats::fct_relevel(month_name, "Jan", "Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"),
month_cont = c(1:132)) %>%
ggplot(aes(x = month_cont, y = rsv, col = year))+geom_line()+
labs(
title = "SKin Bleaching Trend from 2004 To 2018",
x = "Months",
y = "Relative Search Volume"
) +
scale_fill_viridis_d(option = "A", aesthetics = "col")
b1<- skbt %>%
ggplot(aes(x=month_name, y= rsv, col = year, group = year
))+geom_line()+
scale_fill_viridis_d(option = "A", aesthetics = "col")+
labs(title = "Seasonal Plot of Relative Search Volume for years 2008 - 2018")
ggarrange(b0,b2,b1, widths = c(2,2))
b0<- skbt  %>%
mutate(
month_name  = forcats::fct_relevel(month_name, "Jan", "Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"),
month_cont = c(1:132)) %>%
ggplot(aes(x = month_cont, y = rsv, col = year))+geom_line()+
labs(
title = "SKin Bleaching Trend from 2004 To 2018",
x = "Months",
y = "Relative Search Volume"
) +
scale_fill_viridis_d(option = "A", aesthetics = "col")
b1<- skbt %>%
ggplot(aes(x=month_name, y= rsv, col = year, group = year
))+geom_line()+
scale_fill_viridis_d(option = "A", aesthetics = "col")+
labs(title = "Seasonal Plot of Relative Search Volume for years 2008 - 2018")
ggarrange(b0,b1, widths = c(2,2))
b0<- skbt  %>%
mutate(
month_name  = forcats::fct_relevel(month_name, "Jan", "Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"),
month_cont = c(1:132)) %>%
ggplot(aes(x = month_cont, y = rsv, col = year))+geom_line()+
labs(
title = "SKin Bleaching Trend from 2004 To 2018",
x = "Months",
y = "Relative Search Volume"
) +
scale_fill_viridis_d(option = "A", aesthetics = "col")
b1<- skbt %>%
ggplot(aes(x=month_name, y= rsv, col = year, group = year
))+geom_line()+
scale_fill_viridis_d(option = "A", aesthetics = "col")+
labs(title = "Seasonal Plot of Relative Search Volume for years 2008 - 2018")
ggarrange(b0,b1, widths = c(2,3))
b0<- skbt  %>%
mutate(
month_name  = forcats::fct_relevel(month_name, "Jan", "Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"),
month_cont = c(1:132)) %>%
ggplot(aes(x = month_cont, y = rsv, col = year))+geom_line()+
labs(
title = "SKin Bleaching Trend from 2004 To 2018",
x = "Months",
y = "Relative Search Volume"
) +
scale_fill_viridis_d(option = "A", aesthetics = "col")
b1<- skbt %>%
ggplot(aes(x=month_name, y= rsv, col = year, group = year
))+geom_line()+
scale_fill_viridis_d(option = "A", aesthetics = "col")+
labs(title = "Seasonal Plot of Relative Search Volume for years 2008 - 2018")
ggarrange(b0,b1, widths = c(2,3), nrow = 2)
b0<- skbt  %>%
mutate(
month_name  = forcats::fct_relevel(month_name, "Jan", "Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"),
month_cont = c(1:132)) %>%
ggplot(aes(x = month_cont, y = rsv, col = year))+geom_line()+
labs(
title = "SKin Bleaching Trend from 2004 To 2018",
x = "Months",
y = "Relative Search Volume"
) +
scale_fill_viridis_d(option = "A", aesthetics = "col")+theme(legend.position = "bottom")
b1<- skbt %>%
ggplot(aes(x=month_name, y= rsv, col = year, group = year
))+geom_line()+
scale_fill_viridis_d(option = "A", aesthetics = "col")+
labs(title = "Seasonal Plot of Relative Search Volume for years 2008 - 2018")
ggarrange(b0,b1, widths = c(2,3), nrow = 2)
b0<- skbt  %>%
mutate(
month_name  = forcats::fct_relevel(month_name, "Jan", "Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"),
month_cont = c(1:132)) %>%
ggplot(aes(x = month_cont, y = rsv, col = year))+geom_line()+
labs(
title = "SKin Bleaching Trend from 2004 To 2018",
x = "Months",
y = "Relative Search Volume"
) +
scale_fill_viridis_d(option = "A", aesthetics = "col")+theme(legend.position = "bottom")
b1<- skbt %>%
ggplot(aes(x=month_name, y= rsv, col = year, group = year
))+geom_line()+
scale_fill_viridis_d(option = "A", aesthetics = "col")+
labs(title = "Seasonal Plot of Relative Search Volume for years 2008 - 2018")
ggarrange(b0,b1,
#widths = c(2,3),
nrow = 2)
b0<- skbt  %>%
mutate(
month_name  = forcats::fct_relevel(month_name, "Jan", "Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"),
month_cont = c(1:132)) %>%
ggplot(aes(x = month_cont, y = rsv, col = year))+geom_line()+
labs(
title = "SKin Bleaching Trend from 2004 To 2018",
x = "Months",
y = "Relative Search Volume"
) +
scale_fill_viridis_d(option = "A", aesthetics = "col")+theme(legend.position = "bottom")
b1<- skbt %>%
ggplot(aes(x=month_name, y= rsv, col = year, group = year
))+geom_line()+
scale_fill_viridis_d(option = "A", aesthetics = "col")+
labs(title = "Seasonal Plot of Relative Search Volume for years 2008 - 2018")
ggarrange(b0,b1,
#widths = c(2,3),
ncol = 2)
b0<- skbt  %>%
mutate(
month_name  = forcats::fct_relevel(month_name, "Jan", "Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"),
month_cont = c(1:132)) %>%
ggplot(aes(x = month_cont, y = rsv, col = year))+geom_line()+
labs(
title = "SKin Bleaching Trend from 2004 To 2018",
x = "Months",
y = "Relative Search Volume"
) +
scale_fill_viridis_d(option = "A", aesthetics = "col")+theme(legend.position = "bottom")
b1<- skbt %>%
ggplot(aes(x=month_name, y= rsv, col = year, group = year
))+geom_line()+
scale_fill_viridis_d(option = "A", aesthetics = "col")+
labs(title = "Seasonal Plot of Relative Search Volume for years 2008 - 2018")+theme(legend.position = "bottom")
ggarrange(b0,b1,
#widths = c(2,3),
ncol = 2)
skbt %>%
rename(
date = time) %>%
separate(date, into = c("year","month"), sep = "\\-" ) %>%
mutate(
month = as.numeric(month),
month = month.abb[month],
year = as.numeric(year),
month = as.factor(month)) %>%
arrange(year) %>%
group_by(year) %>% #look at change by year | distribution by year | change in the median or mean by year
PercChange( Var = "rsv", slideBy = -1) %>%
summary() %>%
knitr::kable()
skbt %>%
group_by(year) %>% #look at change by year | distribution by year | change in the median or mean by year
PercChange( Var = "rsv", slideBy = -1) %>%
summary() %>%
knitr::kable()
skbt %>%
group_by(year)
skbt %>%
group_by(year) %>% #look at change by year | distribution by year | change in the median or mean by year
PercChange( Var = "rsv", slideBy = -1)
skbt %>%
group_by(year)
skbt %>%
group_by(year) %>% #look at change by year | distribution by year | change in the median or mean by year
PercChange( Var = "rsv", slideBy = 0) %>%
summary() %>%
knitr::kable()
skbt %>%
group_by(year) %>% #look at change by year | distribution by year | change in the median or mean by year
PercChange( Var = "rsv", slideBy = 1) %>%
summary() %>%
knitr::kable()
skbt %>%
group_by(year) %>% #look at change by year | distribution by year | change in the median or mean by year
PercChange( Var = "rsv", slideBy = -2) %>%
summary() %>%
knitr::kable()
skbt %>%
group_by(year) %>% #look at change by year | distribution by year | change in the median or mean by year
PercChange( Var = "rsv", slideBy = -1) %>%
summary() %>%
knitr::kable()
skbt<- read.csv("./data/GtrendData/bleachingTime08_18.csv", header = T, sep = ",",stringsAsFactors = F, col.names = c("time","rsv"))
skbt<- skbt[-1,] %>%
mutate(rsv = as.numeric(rsv)) %>%
rename(
date = time) %>%
separate(date, into = c("year","month"), sep = "\\-" ) %>%
mutate(
month = as.numeric(month),
month_name = month.abb[month],
year_f = as.factor(year),
month_name = as.factor(month_name)) %>%
arrange(year)
b0<- skbt  %>%
mutate(
month_name  = forcats::fct_relevel(month_name, "Jan", "Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"),
month_cont = c(1:132)) %>%
ggplot(aes(x = month_cont, y = rsv, col = year_f))+geom_line()+
labs(
title = "SKin Bleaching Trend from 2004 To 2018",
x = "Months",
y = "Relative Search Volume"
) +
scale_fill_viridis_d(option = "A", aesthetics = "col")+theme(legend.position = "bottom")
b1<- skbt %>%
ggplot(aes(x=month_name, y= rsv, col = year_f, group = year
))+geom_line()+
scale_fill_viridis_d(option = "A", aesthetics = "col")+
labs(title = "Seasonal Plot of Relative Search Volume for years 2008 - 2018")+theme(legend.position = "bottom")
ggarrange(b0,b1,
#widths = c(2,3),
ncol = 2)
skbt %>%
group_by(year) %>% #look at change by year | distribution by year | change in the median or mean by year
PercChange( Var = "rsv", slideBy = -1) %>%
summary() %>%
knitr::kable()
skbt %>%
group_by(year) %>% #look at change by year | distribution by year | change in the median or mean by year
PercChange( Var = "rsv", slideBy = -1) %>%
summary() %>%
knitr::kable()
skbt %>%
pull(rsv) %>%
na.omit() %>%
ts(frequency = 12) %>%
stl( s.window = "periodic") %>%
plot()
skbt %>%
pull(rsv) %>%
na.omit()
skbt %>%
pull(rsv) %>%
ts(frequency = 12) %>%
stl( s.window = "periodic") %>%
plot()
skbt %>%
pull(rsv) %>%
ts(frequency = 12) %>%
stl( s.window = "periodic")
skbt %>%
pull(rsv) %>%
ts(frequency = 12) %>%
stl( s.window = "periodic") %>%
plot()
skbt %>%
group_by(year) %>% #look at change by year | distribution by year | change in the median or mean by year
PercChange( Var = "rsv", slideBy = -1) %>%
summary() %>%
knitr::kable()
skbt %>%
group_by(year) %>% #look at change by year | distribution by year | change in the median or mean by year
PercChange( Var = "rsv", slideBy = 1) %>%
summary() %>%
knitr::kable()
skbt %>%
group_by(year) %>% #look at change by year | distribution by year | change in the median or mean by year
PercChange( Var = "rsv", slideBy = 2) %>%
summary() %>%
knitr::kable()
skbt %>%
group_by(year) %>% #look at change by year | distribution by year | change in the median or mean by year
PercChange( Var = "rsv", slideBy = 3) %>%
summary() %>%
knitr::kable()
skbt %>%
group_by(year) %>% #look at change by year | distribution by year | change in the median or mean by year
PercChange( Var = "rsv", slideBy = -3) %>%
summary() %>%
knitr::kable()
skbt %>%
group_by(year) %>% #look at change by year | distribution by year | change in the median or mean by year
PercChange( Var = "rsv", slideBy = -2) %>%
summary() %>%
knitr::kable()
skbt %>%
group_by(year) %>% #look at change by year | distribution by year | change in the median or mean by year
PercChange( Var = "rsv", slideBy = -1) %>%
summary() %>%
knitr::kable()
skbt %>%
#group_by(year) %>% #look at change by year | distribution by year | change in the median or mean by year
PercChange( Var = "rsv", slideBy = -1) %>%
summary() %>%
knitr::kable()
skbt %>%
na.omit() %>%
group_by(year) %>% #look at change by year | distribution by year | change in the median or mean by year
PercChange( Var = "rsv", slideBy = -1) %>%
summary() %>%
knitr::kable()
skbt %>%
na.omit() %>%
group_by(year) %>% #look at change by year | distribution by year | change in the median or mean by year
PercChange( Var = "rsv", slideBy = -1)
skbt %>%
group_by(year)
skbt %>%
group_by(year_f) %>% #look at change by year | distribution by year | change in the median or mean by year
PercChange( Var = "rsv", slideBy = -1) %>%
summary() %>%
knitr::kable()
skbt %>%
ggAcf()
skbt %>%
ts() %>%
pastecs::trend.test(R = 1) %>%
broom::tidy() %>%
select(method, estimate, p.value) %>%
rename("r" = estimate) %>%
knitr::kable()
skbt %>%
pull(rsv) %>%
ggAcf()
skbt %>%
pull(rsv) %>%
ts() %>%
pastecs::trend.test(R = 1) %>%
broom::tidy() %>%
select(method, estimate, p.value) %>%
rename("r" = estimate) %>%
knitr::kable()
skbt %>%
pull(rsv) %>%
ggAcf()
skbt %>%
pull(rsv) %>%
na.omit() %>%
ts(frequency = 12) %>%
stl( s.window = "periodic") #%>%
skbt %>%
pull(rsv) %>%
na.omit() %>%
ts(frequency = 12) %>%
stl( s.window = "periodic")
#seasadj() %>%
ggsubseriesplot(main = "Skin Bleaching")
skbt %>%
pull(rsv) %>%
na.omit() %>%
ts(frequency = 12) %>%
stl( s.window = "periodic") %>%
#seasadj() %>%
ggsubseriesplot(main = "Skin Bleaching")
skbt %>%
pull(rsv) %>%
na.omit() %>%
ts(frequency = 12) %>%
stl( s.window = "periodic") %>%
ts()
skbt %>%
pull(rsv) %>%
na.omit() %>%
ts(frequency = 12) %>%
stl( s.window = "periodic") %>%
ts() %>%
#seasadj() %>%
ggsubseriesplot(main = "Skin Bleaching")
skbt %>%
pull(rsv) %>%
na.omit() %>%
ts(frequency = 12) %>%
stl( s.window = "periodic") %>%
ts() %>%
seasadj() %>%
ggsubseriesplot(main = "Skin Bleaching")
skbt %>%
pull(rsv) %>%
na.omit() %>%
ts(frequency = 12) %>%
stl( s.window = "periodic") %>%
seasadj() %>%
ggsubseriesplot(main = "Skin Bleaching")
skbr <- read_csv(bleachingregion08_18)
skbr <- read_csv("bleachingregion08_18.csv")
skbr <- read_csv("./data/GtrendData/bleachingregion08_18.csv")
skbr %>%
mutate(rsv = recode(rsv, .missing = 0))
skbr
view(skbr)
skbt %>%
group_by(year) %>% #look at change by year | distribution by year | change in the median or mean by year
ungroup() %>%
PercChange( Var = "rsv", slideBy = -1) %>%
summary() %>%
knitr::kable()
skbt %>%
PercChange( Var = "rsv", slideBy = -1) %>%
summary() %>%
knitr::kable()
skbt %>%
group_by(year, rsv)
skbt %>%
group_by(year, rsv) %>%
PercChange( Var = "rsv", slideBy = -1) %>%
summary() %>%
knitr::kable()
skbt  %>%
PercChange( Var = "rsv", slideBy = -1) %>%
summary() %>%
knitr::kable()
skbr <- read_csv("./data/GtrendData/bleachingregion08_18.csv")
view(skbr)
skbr <- read_csv("./data/GtrendData/bleachingregion08_18.csv")
skbr <- read_csv("./data/GtrendData/bleachingRegion08_18.csv")
skbr <- read_csv("./data/GtrendData/bleachingRegion08_18.csv")
skbr <- read.csv("./data/GtrendData/bleachingRegion08_18.csv", header = T, sep = ",",stringsAsFactors = F, col.names = c("time","rsv"))
skbr %>%  view()
skbr<- skbt[-1,] %>%
mutate(rsv = as.numeric(rsv))
skbr
skbr<- skbr[-1,] %>%
mutate(rsv = as.numeric(rsv))
skbr
skbr <- read.csv("./data/GtrendData/bleachingRegion08_18.csv", header = T, sep = ",",stringsAsFactors = F, col.names = c("time","rsv"))
skbr <- read.csv("./data/GtrendData/bleachingRegion08_18.csv", header = T, sep = ",",stringsAsFactors = F, col.names = c("region","rsv"))
skbr<- skbr[-1,] %>%
mutate(rsv = as.numeric(rsv))
skbr
skbr %>%
recode(rsv, .missing = 0)
skbr %>%
mutate(rsv = recode(rsv, .missing = 0))
skbr %>%
mutate(rsv = recode(rsv, .missing = 0)) %>%
ggplot(aes(x = rsv))+geom_histogram()
skbr %>%
mutate(rsv = recode(rsv, .missing = 0)) %>%
ggplot(aes(x = rsv))+geom_histogram()+labs(title = "Distribution of Regional Relative Search Intersts for year 2008 - 2018")
skbr %>%
mutate(rsv = recode(rsv, .missing = 0)) %>%
ggplot(aes(x = rsv))+geom_histogram(bins = 30 )+labs(title = "Distribution of Regional Relative Search Intersts for year 2008 - 2018")
knitr::opts_chunk$set(echo = TRUE)
library(plotly)
